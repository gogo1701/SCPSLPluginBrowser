@model SCPSLPluginBrowser.Data.DllFile

@{
    ViewData["Title"] = $"Details of {Model.FileName}";
    var userId = User.FindFirst(System.Security.Claims.ClaimTypes.NameIdentifier).Value;
    var userLiked = Model.Likes?.Any(l => l.UserId == userId) ?? false;
}

<h2>Details</h2>

<div class="card">
    <div class="card-header">
        <h3>@Model.FileName</h3>
    </div>
    <div class="card-body">
        <p><strong>Description:</strong> @Model.Description</p>
        @if (Model.User != null)
        {
            <p><strong>Uploaded By:</strong> @Model.User.UserName</p>
        }
        else
        {
            <p><strong>Uploaded By:</strong> User information not available</p>
        }
        <p><strong>Created At:</strong> @Model.CreatedAt</p>
        <img src="@Model.Icon" alt="@Model.FileName" class="img-fluid" style="max-width: 200px;" />
    </div>
    <div class="card-footer">
        <form asp-action="Like" asp-controller="DllFile" method="post">
            <input type="hidden" name="fileId" value="@Model.Id" />
            <button type="submit" class="btn @(userLiked ? "btn-danger" : "btn-success")">
                @(userLiked ? "Unlike" : "Like")
            </button>
            <span class="ml-2">Likes: @Model.Likes?.Count</span>
        </form>
        <a asp-action="Download" asp-route-id="@Model.Id" class="btn btn-primary">Download</a>
        <a asp-action="Index" class="btn btn-secondary">Back to List</a>
    </div>
</div>
